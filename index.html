<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Absensi Rutinan Paskibra</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f6fa;
            margin: 0;
            padding: 0;
        }

        header {
            background: #2d6cdf;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 22px;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        #deleteAllBtn {
            padding: 8px 15px;
            background: #d9534f;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: none;
        }

        .container {
            background: white;
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }

        th {
            background: #2d6cdf;
            color: white;
        }
    </style>
</head>

<body>

<header>
    Absensi Rutinan Paskibra
    <button id="deleteAllBtn">Hapus Semua Data</button>
</header>

<div class="container">
    <h3>Data Rekap Absensi</h3>

    <table id="dataTable">
        <thead>
            <tr>
                <th>Nama</th>
                <th>ID</th>
                <th>Waktu</th>
                <th>Keterangan</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>
</div>

<!-- Firebase -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, onValue, remove } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    // ================================================
    // ðŸ”¥ GANTI CONFIG FIREBASE KAMU DI SINI!
    // ================================================
    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_AUTH_DOMAIN",
        databaseURL: "YOUR_DB_URL",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_BUCKET",
        messagingSenderId: "YOUR_SENDER",
        appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const absensiRef = ref(db, "absensi_rutinan");

    // ADMIN ID
    const adminId = "admin123";

    // cek login
    if (!localStorage.getItem("userId")) {
        localStorage.setItem("userId", "admin123"); // simpan admin sementara
    }

    const currentId = localStorage.getItem("userId");

    // tampilkan tombol delete jika admin
    if (currentId === adminId) {
        document.getElementById("deleteAllBtn").style.display = "inline-block";
    }

    // ================================================
    // MENAMPILKAN DATA DARI FIREBASE KE TABEL
    // ================================================
    const tableBody = document.getElementById("tableBody");

    onValue(absensiRef, (snapshot) => {
        tableBody.innerHTML = ""; // hapus isi lama

        snapshot.forEach(child => {
            const item = child.val();
            const tr = document.createElement("tr");

            tr.innerHTML = `
                <td>${item.nama}</td>
                <td>${item.id}</td>
                <td>${item.waktu}</td>
                <td>${item.keterangan}</td>
            `;

            tableBody.appendChild(tr);
        });
    });

    // ================================================
    // FITUR HAPUS SEMUA DATA
    // ================================================
    document.getElementById("deleteAllBtn").addEventListener("click", () => {
        const setuju = confirm("YAKIN ingin menghapus SEMUA data absensi?");
        if (!setuju) return;

        remove(absensiRef)
            .then(() => {
                alert("Semua data berhasil dihapus!");
            })
            .catch(err => {
                alert("Gagal menghapus: " + err);
            });
    });

</script>

</body>
</html>
