<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Absensi</title>
<style>
    body {
        font-family: Arial;
        background: #f4f6fa;
        padding: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
        background: white;
    }
    th, td {
        padding: 10px;
        border: 1px solid #ddd;
    }
    th {
        background: #2d6cdf;
        color: white;
    }
    tr:nth-child(even) {
        background: #f7f7f7;
    }
</style>
</head>
<body>

<h2>Panel Admin - Data Absensi</h2>

<!-- FILTER TANGGAL -->
<div style="margin: 20px 0;">
    <label><b>Filter Tanggal:</b></label>
    <input type="date" id="filterTanggal" style="padding: 5px;">
    <button onclick="filterByDate()" style="padding: 6px 10px;">Filter</button>
    <button onclick="resetFilter()" style="padding: 6px 10px;">Reset</button>
</div>

<!-- TABEL ABSEN -->
<table id="tabelAbsen">
    <thead>
        <tr>
            <th>Nama</th>
            <th>ID</th>
            <th>Tanggal</th>
            <th>Waktu</th>
            <th>Keterangan</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

const firebaseConfig = {
    apiKey: "YOURKEY",
    authDomain: "YOURDOMAIN",
    databaseURL: "YOURDB",
    projectId: "YOURPROJECTID",
    storageBucket: "YOURBUCKET",
    messagingSenderId: "YOURSENDER",
    appId: "YOURAPPID"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const tabelBody = document.querySelector("#tabelAbsen tbody");

const dbRef = ref(db, "absensi");
onValue(dbRef, snapshot => {
    tabelBody.innerHTML = "";

    snapshot.forEach(child => {
        const data = child.val();

        const row = document.createElement("tr");
        row.setAttribute("data-tanggal", data.tanggal);   // ‚Üê penting untuk filter

        row.innerHTML = `
            <td>${data.nama}</td>
            <td>${data.id}</td>
            <td>${data.tanggal}</td>
            <td>${data.waktu}</td>
            <td>${data.keterangan}</td>
        `;

        tabelBody.appendChild(row);
    });
});
</script>

<!-- FUNGSI FILTER -->
<script>
function filterByDate() {
    const tanggal = document.getElementById("filterTanggal").value;
    if (!tanggal) {
        alert("Pilih tanggal dulu");
        return;
    }

    const rows = document.querySelectorAll("#tabelAbsen tbody tr");

    rows.forEach(row => {
        const dataTanggal = row.getAttribute("data-tanggal");

        if (dataTanggal === tanggal) {
            row.style.display = "";
        } else {
            row.style.display = "none";
        }
    });
}

function resetFilter() {
    document.getElementById("filterTanggal").value = "";
    const rows = document.querySelectorAll("#tabelAbsen tbody tr");
    rows.forEach(row => row.style.display = "");
}
</script>

</body>
</html>
